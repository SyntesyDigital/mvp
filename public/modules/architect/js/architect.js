var architect={currentUserHasRole:function(t){var e=CURRENT_USER;return!!e&&e.roles.filter(function(e){if(e.name==t)return e}).length>0}};architect.dialog={confirm:function(t,e){bootbox.confirm({message:t,buttons:{confirm:{label:"Sí",className:"btn-primary"},cancel:{label:"No",className:"btn-default"}},callback:function(t){e(t)}})}},architect.medias={_dropzone:null,_settings:null,_defaults:{acceptedFiles:"image/jpeg,image/png,image/gif",maxFilesize:20,paramName:"file"},init:function(t){this._settings=$.extend({},this._defaults,t),this.initDropzone(),this.setDatatable()},initDropzone:function(){var t=this,e={url:t._settings.urls.store,uploadMultiple:!1,parallelUploads:1,createImageThumbnails:!1,addRemoveLinks:!1,maxFilesize:t._settings.maxFilesize,paramName:t._settings.paramName};this._dropzone=new Dropzone(t._settings.identifier,e),this._dropzone.on("error",function(t,e){toastr.error(e.errors.file[0])}),this._dropzone.on("totaluploadprogress",function(t){$(".progress-bar").parent().addClass("progress-striped active"),$(".progress-bar").width(t+"%"),$(".progress-bar").html(t+"%")}),this._dropzone.on("maxfilesreached",function(){toastr.error("Too many files added !")}),this._dropzone.on("dragenter",function(){$(".medias-dropfiles").addClass("active")}),this._dropzone.on("dragleave dragend dragover",function(){$(".medias-dropfiles").removeClass("active")}),this._dropzone.on("maxfilesexceeded",function(t){toastr.error("File "+t.name+" is too big !")}),this._dropzone.on("queuecomplete",function(e,a){setTimeout(function(){$(".progress-bar").parent().removeClass("progress-striped active"),$(".progress-bar").width("0%"),$(".progress-bar").html("")},2e3),t._dropzone.removeAllFiles(!0)}),this._dropzone.on("success",function(e,a){t.onSuccessUpload(t)})},onSuccessUpload:function(t){toastr.success("File save correctly"),t.refresh()},setDatatable:function(){var t=this;t._settings.table.DataTable({language:{url:"/modules/architect/plugins/datatables/locales/french.json"},processing:!0,serverSide:!0,pageLength:20,language:{url:"//cdn.datatables.net/plug-ins/1.10.16/i18n/Catalan.json"},ajax:t._settings.table.data("url"),columns:[{data:"preview",name:"preview"},{data:"uploaded_filename",name:"uploaded_filename"},{data:"type",name:"type"},{data:"author",name:"author"},{data:"action",name:"action",orderable:!1,searchable:!1}],initComplete:function(e,a){DataTableTools.init(this,{onDelete:function(e){toastr.success(e.message,"Succès !",{timeOut:3e3}),t.refresh()}}),t.initEvents()}})},refresh:function(){var t=this,e=this._settings.table,a=e.DataTable();a.ajax.reload(function(){t.initEvents(),e.find('[data-toogle="delete"]').each(function(t,e){DataTableTools._delete(a,$(this))})})},initEvents:function(){var t=this;t._settings.table.find(".toogle-edit").off("click").on("click",function(e){e.preventDefault(),void 0!==t._editModal&&t._editModal.modalOpen($(this).data("id"))})}},architect.contents={_settings:null,_defaults:{},init:function(t){this._settings=$.extend({},this._defaults,t),this.setDatatable()},setDatatable:function(){var t=this;t._settings.table.DataTable({processing:!0,serverSide:!0,pageLength:20,language:{url:"//cdn.datatables.net/plug-ins/1.10.16/i18n/Catalan.json"},ajax:t._settings.table.data("url"),columns:[{data:"title",name:"title"},{data:"typology",name:"typology"},{data:"updated",name:"updated"},{data:"author",name:"author"},{data:"status",name:"status"},{data:"action",name:"action",orderable:!1,searchable:!1}],initComplete:function(e,a){DataTableTools.init(this,{onDelete:function(e){toastr.success(e.message,"Succès !",{timeOut:3e3}),t.refresh()}}),t.initEvents()}})},refresh:function(){var t=this,e=this._settings.table,a=e.DataTable();a.ajax.reload(function(){t.initEvents(),e.find('[data-toogle="delete"]').each(function(t,e){DataTableTools._delete(a,$(this))})})},initEvents:function(){var t=this;t._settings.table.find(".toogle-edit").off("click").on("click",function(e){e.preventDefault(),void 0!==t._editModal&&t._editModal.modalOpen($(this).data("id"))})}},architect.tags={_settings:null,_defaults:{},init:function(t){this._settings=$.extend({},this._defaults,t),this.setDatatable()},setDatatable:function(){var t=this;t._settings.table.DataTable({processing:!0,serverSide:!0,pageLength:20,language:{url:"//cdn.datatables.net/plug-ins/1.10.16/i18n/Catalan.json"},ajax:t._settings.table.data("url"),columns:[{data:"name",name:"name"},{data:"action",name:"action",orderable:!1,searchable:!1}],initComplete:function(e,a){DataTableTools.init(this,{onDelete:function(e){toastr.success(e.message,"Success !",{timeOut:3e3}),t.refresh()}}),t.initEvents()}})},refresh:function(){var t=this,e=this._settings.table,a=e.DataTable();a.ajax.reload(function(){t.initEvents(),e.find('[data-toogle="delete"]').each(function(t,e){DataTableTools._delete(a,$(this))})})},initEvents:function(){var t=this;t._settings.table.find(".toogle-edit").off("click").on("click",function(e){e.preventDefault(),void 0!==t._editModal&&t._editModal.modalOpen($(this).data("id"))})}},architect.users={_settings:null,_defaults:{},init:function(t){this._settings=$.extend({},this._defaults,t),this.setDatatable()},setDatatable:function(){var t=this;t._settings.table.DataTable({processing:!0,serverSide:!0,pageLength:20,language:{url:"//cdn.datatables.net/plug-ins/1.10.16/i18n/Catalan.json"},ajax:t._settings.table.data("url"),columns:[{data:"name",name:"name"},{data:"action",name:"action",orderable:!1,searchable:!1}],initComplete:function(e,a){DataTableTools.init(this,{onDelete:function(e){toastr.success(e.message,"Success !",{timeOut:3e3}),t.refresh()}}),t.initEvents()}})},refresh:function(){var t=this,e=this._settings.table,a=e.DataTable();a.ajax.reload(function(){t.initEvents(),e.find('[data-toogle="delete"]').each(function(t,e){DataTableTools._delete(a,$(this))})})},initEvents:function(){var t=this;t._settings.table.find(".toogle-edit").off("click").on("click",function(e){e.preventDefault(),void 0!==t._editModal&&t._editModal.modalOpen($(this).data("id"))})}};